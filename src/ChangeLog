2002-10-05  Timo Schulz  (ts@winpt.org)

	* kex.c (kex_send_init_packet): Fixed memory leak.
	* main.c (gsti_deinit): Free auth struct.
	(gsti_set_client_key): New.
	(gsti_set_client_user): New.
	(gsti_set_auth_method): New.
	(_gsti_free_auth): New.
	* api.h: Added auth struct to the GSTI struct.
	* auth.c (auth_send_init_packet): New.
	(auth_proc_init_packet): New.
	(auth_send_accept_packet): New.
	(auth_proc_accept_packet): New.
	(auth_send_second_packet): New.
	(auth_proc_second_packet): New.
	* utils.c (_gsti_bstring_hash): Moved from kex.c and
	renamed from hash_bstring. Now it's global.
	
2002-10-06  Timo Schulz  (ts@winpt.org)

	* fsm.c (fsm_server_loop): New.
	(fsm_client_loop): New.
	(new_state): Removed. The code is now in the functions above.
	(fsm_loop): Now we use separate loops.
	* auth.c (auth_send_accept_packet): Flush the packet.
	(auth_send_init_packet): Ditto.
	(auth_send_second_packet): Ditto.

2002-10-06  Timo Schulz  (ts@winpt.org)
	* auth.c (auth_send_pkok_packet): New.
	(auth_proc_pkok_packet): New.
	* fsm.c (fsm_server_loop): Send the SSH_MSG_USERAUTH_PK_OK and
	not the SSH_MSG_USERAUTH_SUCCESS twice.
	(fsm_client_loop): Proc the new packets.
	(pubkey.h): Prefix key context with gsti_.
	
2002-10-07  Timo Schulz  (ts@winpt.org)

	* pubkey.c (read_dss_key): Store 'x' in secure memory.
	* auth.c (parse_pkok_packet): New.
	(auth_proc_pkok_packet): Use it here.
	Check the data returned by the server.
	* pubkey.c (_gsti_ssh_cmp_keys): New.
	(_gsti_ssh_cmp_pkname): New.
	* zlib.c: New. Taken from PuTTY. It's a MIT style license
	and so it's compatible with the GPL. 
	But we don't use compression by default.
	* utils.h: Provide zlib prototypes or dummies.
	* main.c (gsti_set_compression): New.
	* kex.c (build_compress_list): New.
	(kex_send_init_packet): Use it here.
	
2002-10-08  Timo Schulz  (ts@winpt.org)

	* utils.c (_gsti_dump_object): Use the logging stuff and
	not fprintf. Support to dump BUFFER's.
	(_gsti_print_string): Removed the FILE* argument.
	Changed all callers.
	* buffer.c (_gsti_buf_putbstr): New.
	* auth.c: Changed all _gsti_buf_putstr to _gsti_buf_putbstr.
	* kex.c: Likewise.
	* api.h: Created zlib struct inside GSTI handle.
	* memory.c (_gsti_xmalloc): Implemented common xfoo memory
	wrapper so they fail when there is a memory problem.
	(_gsti_xrealloc): Ditto.
	(_gsti_xcalloc): Ditto.
	(_gsti_xstrdup): Ditto.
	
2002-10-19  Timo Schulz  (ts@winpt.org)

	* pubkey.c (pktype_from_file): New.
	(gsti_key_load): Use it here and remove the pktype param.
	* packet.c (print_debug_msg): Free buffer.
	* moduli.h: New. Contains various modulus values for the
	DH group exchange method.
	
	
	
	
	
	
	
	
	
	
	
	
	
